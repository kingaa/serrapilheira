---
title: "Efficient scientific inference<br> using stochastic dynamical systems"
author: "Aaron A. King<br>University of Michigan"
output: 
  ioslides_presentation:
    self_contained: true
    css: pomptalk.css
    smart: true
bibliography: ../sbied.bib
csl: ../jss.csl
params:
  prefix: pomptalk
nocite: |
  @Lavine2011, @DomenechdeCelles2016, @DomenechdeCelles2018
---

<!--
Abstract: Scientific questions regarding the mechanistic operation of biological systems are often naturally formulated using Markov processes, but confronting the resulting models with data can be challenging. In this talk, I describe the essence of the difficulty, highlighting both the technical issues and the importance of the "plug-and-play property". I then describe some efficient inference approaches for partially observed Markov processes and illustrate these with examples. I conclude by sketching promising new developments and describing some open problems. 
-->

<!--
LONG ABSTRACT

Many important questions in the epidemiology and ecology of communicable diseases are naturally formulated as questions about the structure and parameterization of dynamical systems models.
Retrospective analyses of data on recurrent outbreaks of such infections can yield answers to these questions, provided one can construct a tight connection between a stochastic model and data.
Because of the centrality of questions regarding model structure, however, and due to the general intractability of most models of interest, there is great value in methods that place minimal restrictions on the form of models and allow comparison of the explanatory and predictive power of disparate models on an efficient and objective basis.
In this talk, I first give examples of some questions of this nature drawn from the epidemiology of pertussis, cholera, and polio [@King2008;@Magpantay2016;@Martinez-Bakker2015].
Key issues involve route or mode of transmission, the nature, strength, and durability of infection- and vaccine-induced immunity, and the ecological mechanisms promoting persistence and resisting eradication of the pathogen.

In the next part of the talk, I motivate and explain the concept of ``plug-and-play'' inference algorithms and highlight three particularly useful algorithms from this class:  
1. particle Markov chain Monte Carlo [@Andrieu2010]
1. synthetic likelihood [@Wood2010;@Fasiolo2014], and
1. iterated filtering [@Ionides2015].

For each of these methods, I explain its key principles, sketch the algorithm structure, and describe its advantages and disadvantages in terms of statistical and computational efficiency.
These methods compare favorably to the ``standard'' and time-honored approaches of data-augmentation Markov chain Monte Carlo and the various Kalman filter extensions and have appreciable advantages over newer methods such as approximate Bayesian computation @Toni2009a.
On the other hand, they can be computationally demanding and face considerable challenges in dealing with high-dimensional data.
I argue that, on balance, there is much to be gained from the capacity to effectively explore the complex, high-dimensional, nonlinear likelihood surfaces associated with questions of scientific interest.
Doing so is greatly facilitated by the availability of software implementing these, and other, plug-and-play algorithms within a flexible modeling environment [@King2016].

To conclude the talk, I demonstrate iterated filtering in practice as a method for answering some of the questions raised in the first part of the talk.
In particular, I show how the likelihood profile and associated tools can be used not only to quantify statistical support for scientific findings but to shed light on how nonlinearity and stochasticity interact to shape infectious disease dynamics.
-->


```{r knitr-opts,include=FALSE,purl=FALSE,cache=FALSE}
source("../_includes/setup.R", local = knitr::knit_global())
knitr::opts_chunk$set(echo=FALSE)
```
```{r prelims,include=FALSE,cache=FALSE}
options(
  keep.source=TRUE,
  stringsAsFactors=FALSE,
  encoding="UTF-8"
  )

set.seed(594709947L)
library(tidyverse)
library(scales)
theme_set(theme_bw())
library(grid)
library(foreach)
library(bbmle)
library(pomp)
```

## Thanks

- Felicia&nbsp;Magpantay, Matthieu&nbsp;Domenech&nbsp;de&nbsp;Cell&egrave;s, Carles&nbsp;Breto, Jennie&nbsp;Lavine, Daihai&nbsp;He
- Ed&nbsp;Ionides, Pej&nbsp;Rohani, Mercedes&nbsp;Pascual
- US National Institutes of Health
- US National Science Foundation
- US NIH/DHS Research and Policy for Infectious Disease Dynamics Program
- US National Center for Ecological Analysis and Synthesis & the "Inference for Mechanistic Models" Working Group

## Theorem

Let $b$ be biology and $m$, mathematics.  
Then $b$ is more interesting than $m$.

### Proof

$m$ is an activity of $M$, the set of mathematicians and computational scientists.
$M\subset B$, where $B$ is the set of biological organisms.
Therefore, $b$ is at least as interesting as $m$.
Moreover, there is at least one element of $b$ that has not yet been mathematically understood.  
Q.E.D.

## Mechanistic models as scientific instruments

In seeking to understand biological phenomena, models are tools for looking at the data.

They focus attention on the discrepancies between our hypotheses and reality.

How to quantify these discrepancies?

The key principle of statistics is that we must *model the error*.

## Mechanistic models as scientific instruments

- In seeking to infer causal mechanism in *intact* biological systems, *dynamics* are especially informative.
- Hypotheses about causal mechanisms can often readily be formalized as dynamical systems models.
- The problems of inference
	- How can we estimate unknown parameters?
	- How can we decide among competing models?
	- How can we extract maximum information from time series data?
	- When do we know when we need a better model vs better data?

## Sources of error

The key principle is that we must model the error.

- Measurement error
- Process noise
    - Environmental trends and fluctuations
    - Unmodeled heterogeneities
    - Model misspecification
    - Unmodeled variables

## Overview

1. Markov models
1. Examples: cholera and pertussis
1. Partially observed Markov processes
1. Plug and play inference methods
1. Plug and play methods in practice
1. Conclusions and recommendations

## Compartmental models and stochastic differential equations

<img src="figs/compartment1.png" height=400>

## Compartmental models and stochastic differential equations

<img src="figs/compartment2.png" height=400>

## Compartmental models and stochastic differential equations

<img src="figs/compartment3.png" height=400>

## Compartmental models and stochastic differential equations

<img src="figs/compartment4.png" height=400>

## Compartmental models and stochastic differential equations

<img src="figs/compartment5.png" height=400>

## Compartmental models and stochastic differential equations

<img src="figs/compartment6.png" height=150>

## Compartmental models and stochastic differential equations

<img src="figs/compartment6.png" height=150>

$$
\begin{aligned}
dN_{XY}&=\lambda\,X\,dt+\sigma_{XY}(X)\,dW_1(t)\\
dN_{X\emptyset}&=\mu\,X\,dt+\sigma_{X\emptyset}(X)\,dW_2(t)\\
\end{aligned}
$$

$$dW_1,dW_2\;\stackrel{i.i.d}{\sim}\;\mathrm{Normal}(0,\sqrt{dt})$$

## Compartmental models and stochastic differential equations

<img src="figs/compartment6.png" height=150>

$$
\begin{aligned}
dX&=B\,dt-dN_{XY}-dN_{X\emptyset}\\
&=B\,dt-(\lambda+\mu)\,X\,dt\\
&\qquad-\sigma_{XY}(X)\,dW_1(t)-\sigma_{X\emptyset}(X)\,dW_2(t)\\
dY&=dN_{XY}\\
&=\lambda\,X\,dt+\sigma_{XY}(X)\,dW_1(t)\\
\end{aligned}
$$


## Overview

1. Markov models
1. Examples: cholera and pertussis
1. Partially observed Markov processes
1. Plug and play inference methods
1. Plug and play methods in practice
1. Conclusions and recommendations

## Endemic cholera

<img src="figs/bengal_map1.png" height=500>

## Endemic cholera

<img src="figs/bengal_map2.png" height=500>

## Endemic cholera

<img src="figs/bengal_map3.png" height=500>

## Endemic cholera

<img src="figs/bengal_map4.png" height=500>

## Endemic cholera

<img src="figs/bengal_map5.png" height=500>


## Endemic cholera

```{r out.width="80%"}
library(cholera)
IndiaCholera |> 
  subset(district %in% c("Midnapore","Dacca","Jalpaiguri")) |>
  subset(district != "Jalpaiguri" | year>1893) |>
  ggplot(aes(x=date,y=cholera.deaths,group=district))+
  geom_line()+
  # scale_y_continuous(trans="sqrt")+
  facet_grid(district~.,scales="free_y")+
  # theme_classic()+
  theme(strip.background=element_blank())+
  labs(x=NULL,y="cholera deaths per month")
```

## Questions

1. Relative importance of human-human vs environmental transmission
1. Duration of infection-induced immunity
1. Roles of seasonal and multiennial climate drivers
    - complex seasonality
    - multiennial cycles
1. Importance of bacteriophage in environment


## Transmission models

<img src="figs/onepath1.png" width=600>

- nonlinear
- stochastic
- nonstationary
- extrinsically driven

## Transmission models

<img src="figs/onepath2.png" width=600>

## Transmission models

<img src="figs/onepath3.png" width=600>

## Transmission models

<img src="figs/onepath4.png" width=600>

## Transmission models

<img src="figs/onepath5.png" width=600>

## Transmission models

<img src="figs/onepath6.png" width=600>

## Transmission models

<img src="figs/phage1.png" width=600>

## Mechanistic models

- How well do each of the models explain the data?
- What insights can we gain into the system's dynamic self-regulation?

Note that the structure of the models corresponds to the questions of scientific interest, without regard to issues of mathematical tractability

## Questions

1. Relative importance of human-human vs environmental transmission
1. Duration of infection-induced immunity
1. Roles of seasonal and multiennial climate drivers
    - complex seasonality
    - multiennial cycles
1. Importance of bacteriophage in environment


## The ongoing pertussis resurgence

<img src="figs/lavine_2011_data.png" height="500">  
[@Lavine2011]

## The ongoing pertussis resurgence

<img src="figs/mddc_opinion_fig2.png" height="500">  
[@DomenechdeCelles2016]


## Question

Why the resurgence?

- Changes in vaccine efficacy
- Vaccine-driven pathogen evolution
- Increased circulation of congeneric pathogens
- Asymptomatic transmission
- Loss of natural immune boosting
- Increased surveillance sensitivity

Key unknowns:

- durability of vaccine-induced immunity
- relative efficacy of natural- and vaccine-derived immunity

## Models of vaccine failure

<img src="figs/pertussis2.png" height="300">  

$$\lambda(t) = \frac{\beta(t)\,(I_1+\theta\,I_2)+\bar{\beta}\,\iota}{N}$$

Post-vaccination infections are observed at a reduced rate, $\eta$.

[@Magpantay2016]

## Models of vaccine failure

<img src="figs/pertussis2.png" height="300">  

- Can we estimate the nature and durability of vaccine-induced protection?
- Which models explain the data adequately?
- Questions of parameter estimation and model selection

[@Magpantay2016]

## Pertussis resurgence in progress

<img src="figs/mass_map1.png" height=450>

[@DomenechdeCelles2018]

## Pertussis resurgence in progress

<img src="figs/mass_map2.png" height=450>

[@DomenechdeCelles2018]

## Pertussis resurgence in progress

<img src="figs/mass_map3.png" height=450>

[@DomenechdeCelles2018]

## Pertussis resurgence in progress

<img src="figs/mass_map4.png" height=450>

[@DomenechdeCelles2018]

## Pertussis resurgence in progress

<img src="figs/mass_map5.png" height=450>

[@DomenechdeCelles2018]

## Pertussis resurgence in progress

<img src="figs/mass_map6.png" height=450>

[@DomenechdeCelles2018]

## Pertussis in Massachusetts

<img src="figs/mass_data.png" height=450>

[@DomenechdeCelles2018]

## Age-structured models of vaccine failure

<img src="figs/pertussis3.png" height="300">  

[@DomenechdeCelles2018]

## Time-varying covariates

<img src="figs/vaccination_rates.png" height="400">  

[@DomenechdeCelles2018]

## Time-varying covariates

<img src="figs/mass_demography.png" height="400">  

[@DomenechdeCelles2018]

## Age-structured contact network

<img src="figs/age-contact.jpg" height="400">  

[@Rohani2010a;@DomenechdeCelles2018]

## Age-structured contact network

<img src="figs/contact_matrices.png" height="480">  

[@Mossong2008;@Fumanelli2012]


## Inference about vaccine failure

<img src="figs/pertussis3.png" height="300">  

- Can we estimate the nature and durability of vaccine-induced protection?
- Which models explain the data adequately?
- Questions of parameter estimation and model selection

[@DomenechdeCelles2018]

## Overview

1. Markov models
1. Examples: cholera and pertussis
1. Partially observed Markov processes
1. Plug and play inference methods
1. Plug and play methods in practice
1. Conclusions and recommendations

## Partially observed Markov processes

<img src="figs/pomp1.png" height="500">  
[@King2016]

## Partially observed Markov processes

<img src="figs/pomp2.png" height="500">  
[@King2016]

## Partially observed Markov processes

<img src="figs/pomp3.png" height="500">  
[@King2016]

## Partially observed Markov processes

<img src="figs/pomp4.png" height="500">  
[@King2016]

## Partially observed Markov processes

<img src="figs/pomp5.png" height="500">
[@King2016]

## Partially observed Markov processes

- observation times: $t_1 < t_2 < \dots < t_N$
- data: $y_{t_n}^*$
- unobserved Markov state process: $X_t$
- measurement process: $Y_t$
- process model (Markov state transition density): $f_n(X_{t_n}|X_{t_{n-1}},\theta)$
- measurement model: $g_n(Y_{t_n}|X_{t_{n-1}},\theta)$
- initial state distribution $f_0(X_{t_0},\theta)$

[@King2016]

## Central problem

The full joint density is:

$$f_{X,Y}(x,y;\theta) = f_0(x_0;\theta)\,\prod_{n=1}^N\!f_{n}(x_n|x_{n-1};\theta)\,g_{n}(y_n|x_n;\theta).$$

The likelihood function is the marginal density for $Y$, evaluated at the data:

$$
\begin{split}
\mathcal{L}(\theta)&=f_{Y}(y^*_1,\dots,y^*_n;\theta)\\
&=\int f_{X,Y}(x_0,\dots,x_N,y^*_1,\dots,y^*N;\theta)\, dx_1\cdots dx_n.
\end{split}
$$


## Perils of mechanistic models

- computing the likelihood requires integrating over $X_t$  
for all $t$
- traditional solution---be very clever:
    - simplify the model to make it statistically tractable
    - devise and tune an inference algorithm (e.g., MCMC sampler) specifically to the model
- but: are we testing just our hypothesis or the statistical method also?
- it is perilous to invest too much time in one model
    - the Pygmalion problem
    - an antidote: the method of multiple working hypotheses


## The &ldquo;plug and play&rdquo; property

Definition: an algorithm has the *plug-and-play property* if it has no need to evaluate the process model density $f(X_t|X_{t-1})$.

Plug-and-play methods access the process model only via simulation.

This puts minimal restrictions on the form of the models that can be entertained.

[@He2010;@King2016]

## Overview

1. Markov models
1. Examples: cholera and pertussis
1. Partially observed Markov processes
1. Plug and play inference methods
1. Plug and play methods in practice
1. Conclusions and recommendations


## Plug and play inference methods

- Feature-based methods
    - Approximate Bayesian computation (ABC)
    - Nonlinear forecasting (NLF)
    - Attractor-reconstruction based methods
    - Probe matching
    - Synthetic likelihood
- Full-information methods (likelihood based)
    - Sequential Monte Carlo (the particle filter)
    - Particle Markov chain Monte Carlo
    - Iterated filtering

Available in the **pomp** software package (King et al. 2016):
[https://kingaa.github.io/pomp/]

## Synthetic likelihood

Given parameters $\theta\in\Theta$ and data $y^*\in\mathcal{Y}$

- Select probes (summary statistics), $\mathbb{S}:\mathcal{Y}\to\mathbb{R}^d$
- Compute observed probes, $s^* = \mathbb{S}(y^*)$
- Simulate $J$ datasets $y_j$ and compute simulated probes $s_j=\mathbb{S}(y_j)$
- Using sample mean, $\mu = \langle s_j \rangle$, and variance, $\Sigma = \langle (s_j-\mu)\,(s_j-\mu)^T \rangle$, compute the synthetic log likelihood
$$\ell_{\mathbb{S}}(\theta) = -\tfrac{1}{2}\,(s^*-\mu)^{T}{\Sigma}^{-1}(s^*-\mu)-\tfrac{1}{2}\,\log((2\pi)^d|\Sigma|)$$
- E.g., maximize $\ell_{\mathbb{S}}$ over $\Theta$

[@Wood2010;@Fasiolo2014]

## The particle filter

- Given $\theta$ and $y^*$, initialize particle swarm by drawing $X^F_{t_0,j}\sim f_0(\cdot|\theta)$, $j=1,\dots,J$
- For $n = 1,\dots,N$,
    - Simulate for prediction: $X^P_{t_{n},j}\sim f_k(\cdot|X^F_{t_{n-1},j},\theta)$
    - Evaluate weights: $w_{n,j} = g(y^*_{t_{n}}|X^P_{t_{n},j},\theta)$
    - Perform weighted resample of $\{X^P_{t_n,j}\}_{j=1}^J$ to obtain $\{X^F_{t_n,j}\}_{j=1}^J$
    - Estimate conditional log likelihood: $\ell_{n}(\theta) = \log\mathrm{Prob}[y^*_{t_n}|y^*_{t_1},\dots,y^*_{t_{n-1}}] = \log\tfrac{1}{J}\sum_j\!w_{n,j}$
- Unbiased estimate of the log likelihood: $\ell(\theta) = \sum_n\,\ell_n(\theta)$

[@Arulampalam2002]

## Particle Markov chain Monte Carlo

- Given $\theta_0$, compute $\ell(\theta_0)$ using the PF
- For $m>0$, draw $\theta^P_m\sim q(\cdot|\theta_{m-1})$
- Compute $\ell(\theta^P_m)$ using the PF
- Generate $U\sim\mathrm{Uniform}(0,1)$
- Set $\theta_m=\begin{cases}\theta^P_m, &\text{if } U<\frac{f_\Theta(\theta^P_m)\exp(\ell(\theta^P_m))}{f_\Theta(\theta_{m-1})\exp(\ell(\theta_{m-1}))},\\ \theta_{m-1},&\text{otherwise.}\end{cases}$
- Repeat until the Markov chain converges

Because the particle filter gives as unbiased, though noisy, estimate of the likelihood, this MCMC converges to the correct target distribution.

[@Andrieu2010]

## Iterated filtering

- main problem with particle filter: *particle depletion*
- basic idea of iterated filtering:
    - replace fixed parameters by parameters that execute a random walk, e.g.,
    $$\theta \mapsto \theta_n \sim \mathrm{Normal}(\theta_{n-1},\sigma)$$
    - this combats particle depletion by introducing variability
    - also permits local exploration of the likelihood surface
    - take $\sigma\to 0$ iteratively
- analogies with simulated annealing

[@Ionides2006;@Ionides2015;@King2016]

## Iterated filtering

- Choose starting point $\theta_0$ and random-walk perturbations $\sigma_{m}$, $m=0,1,2,\dots$.
- Initialize particle swarm by drawing $\theta^F_{j,0} \sim \mathrm{Normal}(\theta_0,\sigma_0)$
- For $m>0$, run PF to obtain $\{\theta^F_{j,m}\}_{j=1}^J$
- Repeat unto convergence
- The $\theta^F$ converge to the maximum likelihood estimate of $\theta$

[@Ionides2015]

## Overview

1. Markov models
1. Examples: cholera and pertussis
1. Partially observed Markov processes
1. Plug and play inference methods
1. Plug and play methods in practice
1. Conclusions and recommendations


## Common model comparison criteria

- The best model agrees with already published results
- The best model is the one that I can estimate before my thesis is due
- The best model is the one that best agrees with my preconceptions
- The best model is the one that makes my supervisor the happiest
- An identifiable model is better than a non-identifiable model
- The best model is the one with the narrowest confidence intervals

## Valid model comparison criteria

- How well does the model fit the data?
    - How does the likelihood compare to benchmark values?
    - Does the model fit well? (fitting best $\ne$ fitting well
)
- How does the model explain the data?
    - What aspects of the data are explained?
    - What aspects are ascribed to noise?
- Model adequacy
    - Are the data consistent with the model's assumptions?
    - If the model were correct, how plausible are the data?

## Valid model comparison criteria

- Predictive power
    - Can the model make accurate out-of-sample predictions?
- What predictions to parameter estimates make about the results of independent studies?
- Fertility
    - Does the model make testable predictions?

## Endemic cholera

<img src="figs/onepath6.png" height=500>  
[@King2008]

## Likelihood profile

```{r dacca-profile1,fig.height=5,out.width="80%",echo=FALSE}
read.csv("data/mle.csv") |>
  filter(dataset=="Dacca") |>
  mutate(
    fatality=clin*deltaI/(delta+deltaI+eps),
    imm=1/eps,
    cutimm=cut(log(imm),breaks=15)
  ) |>
  group_by(cutimm) |>
  filter(loglik==max(loglik)) |>
  ungroup() -> x
fit <- loess(loglik~log(imm),data=x,span=0.5)
data.frame(
  imm=10^seq(log10(0.024),log10(1),length=1000)
) -> nd
nd |>
  mutate(loglik=predict(fit,newdata=nd)) -> nd
x |>
  mutate(smooth.ll=predict(fit)) |>
  ggplot(aes(x=imm,y=loglik))+
  geom_point()+
  geom_smooth(span=0.5)+
  scale_x_continuous(trans="log10",breaks=c(0.01,0.05,0.1,0.5,1))+
  geom_vline(xintercept=range(subset(nd,loglik>max(loglik,na.rm=T)-1.92)$imm),linetype=2)+
  geom_hline(yintercept=max(nd$loglik,na.rm=T)-1.92,linetype=2)+
  labs(x="immune period (yr)",y=expression(log~L))
```

[@King2008]

## Profile trace plots

```{r dacca-profile2,fig.height=5,out.width="80%",echo=FALSE}
read.csv("data/mle.csv") |>
  filter(dataset=="Dacca") |>
  mutate(
    fatality=clin*deltaI/(delta+deltaI+eps),
    imm=1/eps,
    cutimm=cut(log(imm),breaks=15)
  ) |>
  group_by(cutimm) |>
  filter(loglik==max(loglik)) |>
  ungroup() |>
  select(loglik,fatality,imm) |>
  pivot_longer(-imm) |>
  ggplot(aes(x=imm,y=value))+geom_point()+
  facet_grid(name~.,scales="free_y",switch="y")+
  theme(strip.background=element_blank())+
  scale_x_continuous(trans="log10",breaks=c(0.01,0.05,0.1,0.5,1))+
  geom_smooth()+
   labs(x="immune period (yr)",y=NULL)
```  
[@King2008]

## Endemic cholera

```{r cholera_plot}
```

## Endemic cholera

<img src="figs/onepath6.png" width=500>  
Is it necessary that all infected individuals be equally infectious?  
[@King2008]

## Asymptomatic infections

<img src="figs/twopath1.png" width=500>

case fatality: $0.34\pm 0.2$  
duration of immunity $1.5 \pm 0.7~\text{yr}$  
[@King2008]

## Pertussis and vaccine failure

<img src="figs/pertussis2.png" height="300">  

$$\lambda(t) = \frac{\beta(t)\,(I_1+\theta\,I_2)+\bar{\beta}\,\iota}{N}$$

Post-vaccination infections are observed at a reduced rate, $\eta$.

[@Magpantay2016]

## Pertussis and vaccine failure

<img src="figs/italy_theta-eta_profiles.png" width=750>  

Interpretation: in vaccinated hosts, infections are mild to asymptomatic, yet equally infectious

[@Magpantay2016]

## Limits to information

<img src="figs/alphaV_NB_Both_All_CMP.png" width=390>
<img align="right" src="figs/epsilonVL_NB_Both_All_CMP.png" width=390>  

Flat profiles indicate lack of information in the data relative to the question

[@Magpantay2016]


## Exploiting the age structure

<img src="figs/MDDC_2018_Table1.png" width=750>  

<!--
- 10% risk (95% CI [3–19%]) of protection waning within 10 y of vaccination
- 55% have lifelong protection
- primary vaccine failure probability of 4% [1–8%]
-->
- relative transmissibility 0.99 [0.40–1.00]
- relative observability 0.39 [0.19–1.00]
- high detection rates in adolescents and in adults: 24% [10–66%]
- despite effectiveness, eradication via routine immunization alone is not possible  
[@DomenechdeCelles2018]

## Overview

1. Markov models
1. Examples: cholera and pertussis
1. Partially observed Markov processes
1. Plug and play inference methods
1. Plug and play methods in practice
1. Conclusions and recommendations


## Relative merits

- SL throws away information, but gains robustness
- Many choices are possible for SL probes, with consequences for inference
- IF converges much faster than PMCMC
- Frequentist vs Bayesian inference styles
- Smoothed state trajectories can be computed by PMCMC
- Probes can be used for *post hoc* checks of model adequacy

## Recommendation: an integrated approach

- Use IF, profile likelihood, and profile trace plots to identify heights in the likelihood surface.
- Use PMCMC to obtain posterior densities and smoothed state trajectories if desired.
- Use independent parameter estimates to diagnose model misspecification.
- Use probes to ascertain model adequacy and diagnose model misspecification.

## Conclusions

- It is essential to model the error, including both process noise and measurement error.
- Plug-and-play inference methods facilitate scientific investigation.
- Effective, statistically efficient plug-and-play inference methods are available.
- There is an intense need for further methodological development of such methods to improve computational efficiency and accommodate new data types.

<!-- ## Open problems -->

<!-- - New data types: -->
<!-- 	- genetic data -->
<!-- - High-dimensional data -->
<!-- 	- panel data -->
<!-- 	- spatio-temporal data -->
<!-- - Computational challenges -->
<!-- 	- parallelization -->
<!-- 	- online inference -->


## References
